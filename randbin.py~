#!/usr/bin/python
import sys
import subprocess
import time

print("[*] Keylogging random number generator, by Milo Cress")

lsb = 1 # Change me to increase harvesting rate but decrease speed
print("[*] Using the " + str(lsb) + " least significant bit(s) (fewer is better)")

time_old = time.time()
for line in g.stdout:
    if str(line).find("RawKeyPress") > 0:
        time_new = time.time()
        diff = time_new - time_old
        time_old = time_new
        num = str(diff)[-lsb:]
        for i in num:
            if int(i) < 9:
                dice_rolls.append(int(i))

        if len(dice_rolls) > passwd_len * 5:
            print("[*] Sufficient random data gathered.")
            for i in range(passwd_len):
            quit()
        
    sys.stdout.flush() 

class Key_rand:

    def __init__(self):
        g = subprocess.Popen(["xinput", "--test-xi2", "--root"], stdout=subprocess.PIPE)
        print("[*] Started xinput as a subprocess. All keystrokes will now be logged")
